#!/usr/bin/env bash
set -e

STATUS=0

if ! go version; then
  echo "You need to install Go 1.6 or higher to build hub" >&2
  STATUS=1
fi

{ ruby --version
  if [ -n "$TRAVIS" ]; then
    script/cached-bundle install --deployment --jobs=3 --retry=3
  else
    bundle install --path vendor/bundle
  fi
  bundle binstub cucumber ronn --path bin
} || {
  echo "You need Ruby 1.9 or higher and Bundler to run hub tests" >&2
  STATUS=1
}

if [ $STATUS -eq 0 ]; then
  echo "Everything OK."
fi

exit $STATUS
